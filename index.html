<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Fuego: Conexión de Cámara</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #111; display: flex; justify-content: center; align-items: center; }
        #start-button { padding: 20px 40px; font-size: 1.5rem; cursor: pointer; }
        #video-container { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        #camera-video { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>
    <button id="start-button">INICIAR PRUEBA</button>

    <div id="video-container">
        <video id="camera-video" playsinline autoplay muted></video>
    </div>

    <script>
        const startButton = document.getElementById('start-button');
        const videoContainer = document.getElementById('video-container');
        const videoElement = document.getElementById('camera-video');

        startButton.addEventListener('click', async () => {
            console.log("Botón presionado. Realizando la prueba de fuego...");
            startButton.style.display = 'none';
            videoContainer.style.display = 'block';

            try {
                // La petición más simple y universal posible.
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                
                console.log("¡ÉXITO! El navegador entregó el stream de la cámara.");
                videoElement.srcObject = stream;

            } catch (error) {
                // Si esto falla, el problema es fundamental.
                console.error("¡PRUEBA DE FUEGO FALLIDA! El error es:", error);
                alert(`FALLO DE ACCESO A LA CÁMARA.\n\nNOMBRE DEL ERROR:\n${error.name}\n\nMENSAJE:\n${error.message}`);
                
                videoContainer.style.display = 'none';
                startButton.style.display = 'block';
                startButton.innerText = "VOLVER A INTENTAR";
            }
        });
    </script>
</body>
</html>